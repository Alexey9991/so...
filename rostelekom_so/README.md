# Rostelekom-Oriented-Clients-Classification

## Введение
Это - решение для **Хакатона ЦП, 4 кейсРостелекома**

В этом репозитории вы найдете пайплайн решения этого кейса.


## Решение

### Краткий анализ и описание
Для решения задачи предсказания склонности клиента к покупке услуги:
1. На первом шаге производилось восстановление пропущенных значений (например, для восстановления городов, был использован код гексагона, который отражает некоторую площадь на карте).
2. На втором шаге был проведен полный анализ зависимости признаков пользователя. Это позволило избавиться от ненужных признаков и выявить полезную информацию о пользователе для дальнейшего анализа.
3. Далее были подкреплены дополнительные данные (с Росстата): средние цены на стоимость услуг телефонии и интернета, демографические данные (населенность и достаток по городам, отдельным участкам на карте по географическим координатам).
4. Был произведен географический анализ по городам с использованием открытых данных и координат пользователя (широта, долгота). В результате этого удалось построить детальную географию пользователей и выявить между ними полезную корреляцию, которая будет крайне полезна для модели машинного обучения.
5. Далее предстояла разработка модели машинного обучения, которая позволила добиться высокого качества предсказания (95%). В процессе были протестированы самые разные решения (перцептрон, архитектура рекуррентных нейронных сетей LSTM c использованием трансформера и др.). В результате было принято решение использовать модель от Яндекса.

### Внешние данные
##### Росстат - средняя цена на услуги интернета и телефонии по городам
Мы использовали [Датасет 2021-2022 г.](https://www.kaggle.com/tahsin/cassava-leaf-disease-merged) для тренировки, который впоследствии дополнили в результате построения карты координат отсутствующих городов и городов близлежащих на карте.


### Модели
- Perceptron Based TF Model
- LSTM + Transformer
- Yandex Catboost


### Финальные результаты
Мы использовали три модели и получили следующие результаты:

1) Tensorflow Simple Perceptron
**Private LB: 0.97;**

2) LSTM + Transformer
**Private LB: не хватило времени на тренировку;**

3) Yandex CatBoost + Custom Loss
**Private LB: 0.96;**

## Структура репозитория
- **Py Files** - папка, в которой находятся Python файлы с необходимыми функциями
  - data.ipynb - data preprocessing function
  - train.py - train function
  - main.py - prediction function

- **experiments** - bonus code for experiments
  - LSTM.py - code for training LSTM + Transformers
  - Perceptrons.ipynb - Jupiter Notebook for Perceptrons


*Don't deal with the noise...*